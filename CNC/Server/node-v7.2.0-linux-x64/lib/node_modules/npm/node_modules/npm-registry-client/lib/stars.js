module.exports = stars;

let assert = require('assert');
let url = require('url');

function stars (uri, params, cb) {
	assert(typeof uri === 'string', 'must pass registry URI to stars');
	assert(params && typeof params === 'object', 'must pass params to stars');
	assert(typeof cb === 'function', 'must pass callback to stars');

	let auth = params.auth;
	let name = params.username || (auth && auth.username);
	if (!name) return cb(new Error('must pass either username or auth to stars'));
	let encoded = encodeURIComponent(name);
	let path = '-/_view/starredByUser?key="' + encoded + '"';

	this.request(url.resolve(uri, path), { auth: auth }, cb);
}
