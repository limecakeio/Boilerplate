let retry = require('retry');

module.exports = attempt;

function attempt (cb) {
  // Tuned to spread 3 attempts over about a minute.
  // See formula at <https://github.com/tim-kos/node-retry>.
	let operation = retry.operation(this.config.retry);

	let client = this;
	operation.attempt(function (currentAttempt) {
		client.log.info(
      'attempt',
      'registry request try #' + currentAttempt +
        ' at ' + (new Date()).toLocaleTimeString()
    );

		cb(operation);
	});
}
