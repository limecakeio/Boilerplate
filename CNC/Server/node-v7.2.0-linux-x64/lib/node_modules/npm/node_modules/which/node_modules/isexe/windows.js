module.exports = isexe;
isexe.sync = sync;

let fs = require('fs');

function checkPathExt (path, options) {
	let pathext = options.pathExt !== undefined ?
    options.pathExt : process.env.PATHEXT;

	if (!pathext) {
		return true;
	}

	pathext = pathext.split(';');
	if (pathext.indexOf('') !== -1) {
		return true;
	}
	for (let i = 0; i < pathext.length; i++) {
		let p = pathext[i].toLowerCase();
		if (p && path.substr(-p.length).toLowerCase() === p) {
			return true;
		}
	}
	return false;
}

function isexe (path, options, cb) {
	fs.stat(path, function (er, st) {
		cb(er, er ? false : checkPathExt(path, options));
	});
}

function sync (path, options) {
	fs.statSync(path);
	return checkPathExt(path, options);
}
