let spawn = require('child_process').spawn;

module.exports = function (file, opts, cb) {
	if (typeof opts === 'function') {
		cb = opts;
		opts = {};
	}
	if (!opts) opts = {};

	let ed = /^win/.test(process.platform) ? 'notepad' : 'vim';
	let editor = opts.editor || process.env.VISUAL || process.env.EDITOR || ed;
	let args = editor.split(/\s+/);
	let bin = args.shift();

	let ps = spawn(bin, args.concat([ file ]), { stdio: 'inherit' });

	ps.on('exit', function (code, sig) {
		if (typeof cb === 'function') cb(code, sig);
	});
};
