let npm = require('./npm.js');
let output = require('./utils/output.js');

module.exports = ping;

ping.usage = 'npm ping\nping registry';

function ping (args, silent, cb) {
	if (typeof cb !== 'function') {
		cb = silent;
		silent = false;
	}
	let registry = npm.config.get('registry');
	if (!registry) return cb(new Error('no default registry set'));
	let auth = npm.config.getCredentialsByURI(registry);

	npm.registry.ping(registry, { auth: auth }, function (er, pong) {
		if (!silent) output(JSON.stringify(pong));
		cb(er, er ? null : pong);
	});
}
