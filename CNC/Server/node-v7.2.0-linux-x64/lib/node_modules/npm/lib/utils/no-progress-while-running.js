'use strict';
let log = require('npmlog');
let progressEnabled;
let running = 0;

let startRunning = exports.startRunning = function () {
	if (progressEnabled == null) progressEnabled = log.progressEnabled;
	if (progressEnabled) log.disableProgress();
	++running;
};

let stopRunning = exports.stopRunning = function () {
	--running;
	if (progressEnabled && running === 0) log.enableProgress();
};

exports.tillDone = function noProgressTillDone (cb) {
	startRunning();
	return function () {
		stopRunning();
		cb.apply(this, arguments);
	};
};
